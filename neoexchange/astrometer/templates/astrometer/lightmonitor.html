{% extends 'base.html' %}
{% load staticfiles %}

{% block bodyclass %}page lightmonitor{%endblock%}

{%block header %}Light Monitor for block {{object.id}}{%endblock%}

{% block script-content %}
<script src="https://code.createjs.com/createjs-2015.11.26.min.js"  type="text/javascript" ></script>
<script src="{% static "core/js/astrometer.js" %}"  type="text/javascript" ></script>
<script>
	var stage;
	var ministage;
	var index = 0;
	var point_size = 10;
	var blinker;
	var img_holder;
	var mini_img;
	var frames = {{images|safe}}
	var data_url = 'http://data.lcogt.net/thumbnail/'
	var img_params = '/?width=1000&height=1000&gamma=2.5&label=0'

	$(document).ready(function(){
		setUp();

		$('.image_switch').click(function(){
				console.log("here")
				var frameid = $(this).data('imgsrc');
				console.log(frameid);
				changeImage(frameid);
		});
	});

</script>
{% endblock %}

{% block upper-menu%}

{%endblock%}

{% block extramenu %}
    <div class="headingleft">
        <h1>Light Monitor for block: <a href="{% url 'block-view' object.id  %}" class="objectspecific">#{{object.id}}</a></h1>
    </div>
{% endblock%}

{% block main-content %}
<!-- Main body -->
<div class="container" id="main">
        <div class="row">
            <div class="eight columns">
                <h3 class="section-title">Find the moving object!</h3>
{% if messages %}					<div id="message">
						<ul class="messages">
{% for message in messages %}{%ifchanged%}<li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message|safe }}</li>{%endifchanged%}{% endfor %}
						</ul>
					</div>{% endif %}

					<div id="middle">
						<div id="wrapper">
							<canvas id="imgCanvas" width="600" height="600"><p>Image has failed to load.</p></canvas>
						</div>
					</div>
				</div>

        <div class="four columns">
					<h3 class="section-title">Zoom Region</h3>
					<canvas id="zoomCanvas" width="200" height="200"><p>Image has failed to load.</p></canvas>
					<div id="frame_id_holder"></div>

          {% if images %}
          <h3 class="section-title">Image Sequence</h3>
							<div id="blink-buttons-holder">
								<button id="start" onclick="startBlink();">Blink</button>
								<button id="stop" onclick="stopBlink();">STOP</button>
							</div>
              <ul class="observations">
              {% for img in images %}
              <li class="thumb"><a href="#main" class="image_switch" data-imgsrc='{{forloop.counter0}}'><img src="http://data.lcogt.net/thumbnail/{{img.img}}/?width=50&height=50&gamma=2.5&label=0"></a></li>
              {% endfor %}
              </ul>
          {% endif %}
        </div>
      </div>
    </div>
{% endblock %}
